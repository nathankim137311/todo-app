(()=>{"use strict";class t{static showForm(t){const e=t.target.textContent;"Add Task"===e?(t.target.style.backgroundColor="red",t.target.textContent="Close",document.getElementById("form-container").classList.add("active")):"Close"===e&&(t.target.style.backgroundColor="#5865F2",t.target.textContent="Add Task",document.getElementById("form-container").classList.remove("active"))}static removeAllChildNodes(t){for(;t.firstChild;)t.removeChild(t.firstChild)}static filter(t){return JSON.parse(localStorage.getItem("tasks")).filter((e=>e.project===t))}static defaultValue(t,e){for(let s,a=0;s=t.options[a];a++)if(s.value==e){t.selectedIndex=a;break}}static findSumOfArray(t){let e=0;for(let s in t)e+=t[s];return e}static getOccAndNames(t){const e=t.reduce(((t,e)=>t.set(e,(t.get(e)||0)+1)),new Map);return[[...e.values()],[...e.keys()]]}static sortByToday(t){const e=JSON.parse(localStorage.getItem("tasks")),s=[];for(let a=0;a<e.length;a++)e[a].date===t&&s.push(e[a]);return 0!==s.length&&s}static getCurrentDate(){let t=new Date;const e=String(t.getDate()).padStart(2,"0"),s=String(t.getMonth()+1).padStart(2,"0"),a=t.getFullYear();return t=a+"-"+s+"-"+e,t}}class e{static toggleStatus(t,e){const s=JSON.parse(localStorage.getItem("tasks")),a=s.findIndex((e=>e.id==t));s[a].status=e,localStorage.setItem("tasks",JSON.stringify(s))}}class s{static createCounters(){const e=JSON.parse(localStorage.getItem("tasks")).map((t=>t.project)),s=t.getOccAndNames(e),a=s[0],n=s[1];this.addCountersToDom(n,a),this.addOccToInbox(a)}static addCountersToDom(t,e){for(let s=0;s<t.length;s++){const a=document.getElementById(`${t[s]}`),n=document.createElement("div");n.classList.add("project-counter");const o=document.createElement("p");o.classList.add("counter-integer"),n.appendChild(o),a.appendChild(n),o.textContent=`${e[s]}`}}static addOccToInbox(e){const s=t.findSumOfArray(e),a=document.getElementById("all-tasks-container"),n=document.createElement("div"),o=document.createElement("p");o.classList.add("counter-integer"),o.textContent=s,n.classList.add("project-counter"),n.appendChild(o),a.appendChild(n)}static updateCounters(){document.querySelectorAll(".project-counter").forEach((t=>t.remove())),this.createCounters()}}class a{constructor(t,e,s,n,o){this.id=JSON.parse(localStorage.getItem("id"))+1,this.title=t,this.description=e,this.project=s,this.priority=n,this.date=o,this.status="incomplete",a.saveId(this.id)}static saveId(t){const e=t;localStorage.setItem("id",JSON.stringify(e))}static clearTaskList(){document.getElementById("task-list").innerHTML=""}static createNewTaskList(t){for(let e=0;e<t.length;e++)n(t[e])}}function n(a){const n=document.getElementById("task-list"),o=document.createElement("li");o.classList.add("todo-item-container");const c=document.createElement("div"),i=document.createElement("div");i.classList.add("todo-item"),i.setAttribute("id",`${a.id}`);const d=document.createElement("div");d.classList.add("task-info-div"),i.addEventListener("click",(()=>{d.classList.toggle("show")}));const r=document.createElement("div");r.classList.add("info-container-1");const l=document.createElement("span");l.textContent=`Project: ${a.project}`;const u=document.createElement("label");u.htmlFor="title-"+a.id,u.textContent="Title:";const m=document.createElement("input");m.setAttribute("id","title-"+a.id),m.setAttribute("type","text"),m.setAttribute("readonly","readonly"),m.textContent=`${a.title}`,m.setAttribute("value",`${a.title}`),m.classList.add("detail-inputs-"+a.id);const p=document.createElement("label");p.htmlFor="date-"+a.id,p.textContent="Due date:";const g=document.createElement("input");g.setAttribute("id","date-"+a.id),g.classList.add("detail-inputs-"+a.id),g.setAttribute("type","date"),g.setAttribute("value",`${a.date}`),g.setAttribute("readonly","readonly");const y=document.createElement("label");y.htmlFor="priority-"+a.id,y.textContent="Priority level:";const E=document.createElement("select");E.setAttribute("id","priority-"+a.id),E.classList.add("detail-inputs-"+a.id),E.setAttribute("value",a.priority),E.setAttribute("disabled","disabled");const h=document.createElement("option");h.setAttribute("value","low"),h.textContent="Low";const v=document.createElement("option");v.setAttribute("value","medium"),v.textContent="Medium";const k=document.createElement("option");k.setAttribute("value","high"),k.textContent="High",E.append(h,v,k),t.defaultValue(E,a.priority);const C=document.createElement("button");C.setAttribute("id","edit-btn"),C.innerHTML='<span class="material-icons-outlined">edit</span>',C.addEventListener("click",(()=>{(class{static toggleEdit(t,e){const s=[...document.querySelectorAll(".detail-inputs-"+e)];"Save"!==t.innerHTML?(t.innerHTML="Save",s.forEach((t=>{t.readOnly=!1,t.style.border="1px #5865F2 solid",t.removeAttribute("disabled")}))):(t.innerHTML='<span class="material-icons-outlined">edit</span>',s.forEach((t=>{t.readOnly=!0,t.style.border="1px transparent solid"})),this.saveEdit(e))}static saveEdit(t){const e=document.getElementById("title-"+t),s=document.getElementById("description-"+t),a=document.getElementById("date-"+t),n=document.getElementById("priority-"+t),o=JSON.parse(localStorage.getItem("tasks")),c=o.map((t=>t.id)).indexOf(t);o[c].title=e.value,o[c].description=s.value,o[c].date=a.value,o[c].priority=n.value,localStorage.setItem("tasks",JSON.stringify(o)),location.reload()}}).toggleEdit(C,a.id)})),r.append(l,u,m,p,g,y,E);const I=document.createElement("label");I.htmlFor="description-"+a.id,I.textContent="Description:";const S=document.createElement("textarea");S.setAttribute("id","description-"+a.id),S.classList.add("detail-inputs-"+a.id),S.setAttribute("type","text"),S.setAttribute("readonly","readonly"),S.textContent=`${a.description}`,S.setAttribute("value",`${a.description}`),d.append(r,I,S,C);const L=document.createElement("div");L.classList.add("container-1");const f=document.createElement("input");f.classList.add("checkbox"),f.setAttribute("type","checkbox");const b=document.createElement("span");b.textContent=`${a.title}`,"complete"===a.status&&(f.checked=!0,o.classList.add("active")),f.addEventListener("change",(()=>{o.classList.toggle("active"),d.classList.remove("show"),f.checked?e.toggleStatus(a.id,"complete"):e.toggleStatus(a.id,"incomplete")})),L.append(b,f);const x=document.createElement("div");x.classList.add("container-2");const A=document.createElement("div"),N=document.createElement("span");N.innerHTML='<span class="material-icons-outlined"><a id="delete-icon" title="delete task" href="#">delete</a></span>',N.addEventListener("click",(t=>{t.stopPropagation();const e=t.target.parentNode.parentNode.parentNode.parentNode.id;t.target.parentNode.parentNode.parentNode.parentNode.parentNode.remove(),function(t){const e=JSON.parse(localStorage.getItem("tasks")),s=e.findIndex((e=>e.id==t));e.splice(s,1),localStorage.setItem("tasks",JSON.stringify(e))}(e),s.updateCounters()})),x.append(A,N),function(t,e){switch(t.toLowerCase()){case"high":e.style.backgroundColor="#FF0000";break;case"medium":e.style.backgroundColor="#FECD19";break;case"low":e.style.backgroundColor="#6FB202"}}(a.priority,A),n.appendChild(o),o.appendChild(c),c.append(i,d),i.append(L,x)}class o{static createProject(e){const s=document.getElementById("project-list"),o=document.getElementById("project-heading");t.removeAllChildNodes(s);for(let n=0;n<e.length;n++){const c=document.createElement("li"),i=document.createElement("div");i.setAttribute("id",`${e[n]}`);const d=document.createElement("a");d.setAttribute("href","#"),d.textContent=`${e[n]}`,i.appendChild(d),d.addEventListener("click",(()=>{const e=d.textContent;o.textContent=e,a.clearTaskList();const s=t.filter(e);a.createNewTaskList(s)})),s.appendChild(c),c.appendChild(i)}const c=document.getElementById("all-tasks");c.addEventListener("click",(()=>{o.textContent=c.textContent,a.clearTaskList();const t=JSON.parse(localStorage.getItem("tasks"));for(let e=0;e<t.length;e++)n(t[e])}));const i=document.getElementById("today");i.addEventListener("click",(()=>{o.textContent=i.textContent,class{static today(){const e=t.getCurrentDate(),s=t.sortByToday(e);if(0!==s.length){a.clearTaskList();for(let t=0;t<s.length;t++)n(s[t])}}}.today()}))}}let c=[],i=[];class d{static saveTask(t){c.push(t),localStorage.setItem("tasks",JSON.stringify(c))}static saveProject(t){i.push(t);const e=[...new Set(i)];return localStorage.setItem("projects",JSON.stringify(e)),e}}class r extends d{static itemsFromStorage(){this.tasks(),this.projects(),this.counters(),this.indicator()}static tasks(){null===localStorage.getItem("tasks")?c=[]:(c=JSON.parse(localStorage.getItem("tasks")),this.loadTasks(c))}static projects(){null===localStorage.getItem("projects")?i=[]:(i=JSON.parse(localStorage.getItem("projects")),this.loadProjects(i))}static counters(){null===localStorage.getItem("tasks")?c=[]:s.createCounters()}static indicator(){null===localStorage.getItem("tasks")?c=[]:!1!==t.sortByToday(t.getCurrentDate())&&class{static redIndicator(){const t=document.getElementById("today-container"),e=document.createElement("div");e.classList.add("today-indicator"),t.appendChild(e)}}.redIndicator()}static loadTasks(t){for(let e=0;e<t.length;e++)n(t[e])}static loadProjects(t){o.createProject(t)}}let l=!1;const u=document.getElementById("form"),m=document.getElementById("add-task-link"),p=document.getElementById("add-task-btn"),g=document.getElementById("project-link"),y=document.getElementById("sort-priority"),E=document.getElementById("sort-date");window.onload=function(){r.itemsFromStorage()},u.addEventListener("click",(t=>{t.preventDefault()})),m.addEventListener("click",(e=>{t.showForm(e)})),p.addEventListener("click",(()=>{const t=function(){const t=document.getElementById("title-input").value,e=document.getElementById("description-input").value,s=document.getElementById("project-input").value,o=document.getElementById("priority-input").value,c=document.getElementById("date-input").value,i=new a(t,e,s,o,c);return n(i),i}();d.saveTask(t);const e=d.saveProject(t.project);o.createProject(e),s.updateCounters()})),g.addEventListener("click",(()=>{document.getElementById("project-list").classList.toggle("active")})),y.addEventListener("click",(()=>{console.log("sort priority")})),E.addEventListener("click",(()=>{(class{static sortDateClosest(){const t=JSON.parse(localStorage.getItem("tasks"));t.sort(((t,e)=>new Date(e.date)-new Date(t.date))),a.clearTaskList();for(let e=0;e<t.length;e++)n(t[e]);l=!0}static sortDateFurthest(){const t=JSON.parse(localStorage.getItem("tasks"));t.sort(((t,e)=>new Date(e.date)-new Date(t.date))),t.reverse(),a.clearTaskList();for(let e=0;e<t.length;e++)n(t[e]);l=!1}static toggleSort(){l?this.sortDateFurthest():this.sortDateClosest()}}).toggleSort()}))})();